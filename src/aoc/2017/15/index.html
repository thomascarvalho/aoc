<!DOCTYPE html>
<html><head><meta charset="UTF-8"><meta content="width=device-width, initial-scale=1" name="viewport"><meta content="First things first, let&apos;s load our input and parse it" property="og:description"><meta content="Solution" property="og:title"><meta content="article:clerk" property="og:type"><meta content="summary_large_image" name="twitter:card"><link href="./../../../../_data/8Vuwe3UJpobgAT3ZF2NrTxq6rma7qbTFQJqY7446NVYsKKtx7pDvDPmqj3eVzscvg78CsM2mkTWjF5Z1pXcvR3Wojh.css" rel="stylesheet" type="text/css"><script src="https://storage.clerk.garden/nextjournal/clerk-assets@43sknWSpfsWGp1HAfZe1dLuBjmWH/viewer.js?immutable=true" type="module"></script><link href="https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/katex.min.css" rel="stylesheet" type="text/css"><link href="https://fonts.bunny.net" rel="preconnect"><link href="https://fonts.bunny.net/css?family=fira-mono:400,700%7Cfira-sans:400,400i,500,500i,700,700i%7Cfira-sans-condensed:700,700i%7Cpt-serif:400,400i,700,700i" rel="stylesheet" type="text/css"><style id="extra-styles">em {
  font-style: normal !important;
}

html:not(.dark) {
  background-color: #f4f3f3;
}

html.dark {
  background-color: #222831 !important;
}

body {
  background: transparent !important;
}

html:not(.dark) pre {
  background-color: #f1f5f9 !important;
  color: #7aaac4 !important;
}

.font-display {
  font-family: 'Fira Sans Condensed', sans-serif;
}

.dark em {
  color: #fff !important;
  text-shadow: 0 0 5px #fff !important;
}

.dark pre {
  background-color: rgb(31 41 55 / var(--tw-bg-opacity)) !important;
}

html:not(.dark) em {
  color: #000 !important;
  text-shadow: 0 0 2px #000 !important;
}

.viewer-result:first-child {
  display: none !important;
}

.notebook-viewer > pre > code {
  background: transparent !important;
}

.notebook-viewer
  :is(:where(code):not(:where([class~="not-prose"], [class~="not-prose"] *))),
.markdown-viewer
  :is(:where(code):not(:where([class~="not-prose"], [class~="not-prose"] *))) {
  background-color: transparent;
}
</style></head><body class="dark:bg-gray-900"><div id="clerk"></div><script type="module">let viewer = nextjournal.clerk.sci_env
let state = "{:bundle? false, :path->doc {\"src/aoc/2017/15\" {:path [], :nextjournal/value {:toc [{:title \"Solution\", :emoji nil, :path \"#solution\", :items [{:title \"Part 1\", :emoji nil, :path \"#part-1\", :items []} {:title \"Part 2\", :emoji nil, :path \"#part-2\", :items []}]} {:title \"Tests\", :emoji nil, :path \"#tests\", :items []}], :sidenotes? false, :toc-visibility true, :atom-var-name->state #viewer-eval (nextjournal.clerk.render/intern-atoms! {}), :ns #viewer-eval (ns aoc.2017.15), :file \"src/aoc/2017/15.clj\", :scope aoc.2017.15, :bundle? false, :header {:path [], :nextjournal/value [:div.viewer.w-full.max-w-prose.px-8.not-prose.mt-3 [:div.mb-8.text-xs.sans-serif.text-slate-400 nil [:<> [:a.font-medium.border-b.border-dotted.border-slate-300.hover:text-indigo-500.hover:border-indigo-500.dark:border-slate-500.dark:hover:text-white.dark:hover:border-white.transition {:href \"./../../../../\"} \"Index\"] [:span.mx-2 \"â€¢\"]] [:span \"Served from \" [:a.font-medium.border-b.border-dotted.border-slate-300.hover:text-indigo-500.hover:border-indigo-500.dark:border-slate-500.dark:hover:text-white.dark:hover:border-white.transition {:href \"https://clerk.vision\"} \"Clerk\"] nil]]], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-html, :hash \"5dtFMoRpfSur3BJ5RKN8sHB4mECYMZ\"}}, :open-graph {:type \"article:clerk\", :title \"Solution\", :description \"First things first, let's load our input and parse it\"}, :title \"Solution\", :blocks [{:path [], :nextjournal/value [:div.viewer.markdown-viewer.w-full.max-w-prose.px-8 {:data-block-id \"aoc.2017.15/markdown-5dtn8GCqw2urNoSmsQ2X8JrdZtqMfk\"} [\"h1\" {:id \"solution\"} [:<> \"Solution\"]] [:p [:<> \"First things first, let's load our input and parse it\"]]], :nextjournal/render-opts {:id \"aoc.2017.15/markdown-5dtn8GCqw2urNoSmsQ2X8JrdZtqMfk\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/markdown-node-viewer, :render-fn #viewer-fn identity, :hash \"5dsjzwxRkivFXiBf1NDMWmH54cVWV1\"}} {:path [], :nextjournal/value \"(def a-factor 16807)\", :nextjournal/render-opts {:loc {:line 15, :end-line 15, :column 1, :end-column 21}, :id \"aoc.2017.15/a-factor-code\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-block-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code-block, :hash \"5dtogCRMFvgKZ3gMGuwZAef65oxRZD\"}} {:path [], :nextjournal/value {:nextjournal/presented {:path [], :nextjournal/value 16807, :nextjournal/viewer {:name nextjournal.clerk.viewer/number-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-number, :hash \"5drsU4XXFvRiNxHZXiNRRP4gBX7jiW\"}, :nextjournal/render-opts {:id \"aoc.2017.15/a-factor-result\"}}, :nextjournal/blob-id \"5dsu7PqHrYiYw5JHiewjbALihjbzks\", :nextjournal/fetch-opts {:blob-id \"5dsu7PqHrYiYw5JHiewjbALihjbzks\"}, :nextjournal/hash \"8Vv2wKKNJJHZ71W5h7ftZnY3xbUsMJN7vKAKnseP74btx5qFkzgpjCmqHPWTF6AfrrFJJU6SFyyGq3rc1mHzCaLtgE\"}, :nextjournal/render-opts {:id \"aoc.2017.15/a-factor-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/result-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-result, :hash \"5dryaWFamQn5VBuSHLJXGpfgbLUTKh\"}} {:path [], :nextjournal/value \"(def b-factor 48271)\", :nextjournal/render-opts {:loc {:line 16, :end-line 16, :column 1, :end-column 21}, :id \"aoc.2017.15/b-factor-code\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-block-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code-block, :hash \"5dtogCRMFvgKZ3gMGuwZAef65oxRZD\"}} {:path [], :nextjournal/value {:nextjournal/presented {:path [], :nextjournal/value 48271, :nextjournal/viewer {:name nextjournal.clerk.viewer/number-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-number, :hash \"5drsU4XXFvRiNxHZXiNRRP4gBX7jiW\"}, :nextjournal/render-opts {:id \"aoc.2017.15/b-factor-result\"}}, :nextjournal/blob-id \"5du5pzzLeTMygumLMCNaUaCaZWYq9t\", :nextjournal/fetch-opts {:blob-id \"5du5pzzLeTMygumLMCNaUaCaZWYq9t\"}, :nextjournal/hash \"8VvQis4o9sxG8rma69pU4bBKnbqE5jzvTjM2rSGkj2UQWzSPkJk8QWH3NQshSHYLxWJdpyKikb9neaTtGhWzwvEuQd\"}, :nextjournal/render-opts {:id \"aoc.2017.15/b-factor-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/result-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-result, :hash \"5dryaWFamQn5VBuSHLJXGpfgbLUTKh\"}} {:path [], :nextjournal/value \"(defn generate-value [start factor]\\n  (rem (* start factor) 2147483647))\", :nextjournal/render-opts {:loc {:line 18, :end-line 19, :column 1, :end-column 37}, :id \"aoc.2017.15/generate-value-code\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-block-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code-block, :hash \"5dtogCRMFvgKZ3gMGuwZAef65oxRZD\"}} {:path [], :nextjournal/value {:nextjournal/presented {:path [], :nextjournal/value \"#object[aoc.2017.15$generate_value 0x64ce7555 \\\"aoc.2017.15$generate_value@64ce7555\\\"]\", :nextjournal/viewer {:name nextjournal.clerk.viewer/read+inspect-viewer, :render-fn #viewer-fn (fn [x] (try [nextjournal.clerk.render/inspect (nextjournal.clerk.viewer/read-string-without-tag-table x)] (catch js/Error _e (nextjournal.clerk.render/render-unreadable-edn x)))), :hash \"5du3nEWKL6ov9p2VcYkP5JLW7a9Hwz\"}, :nextjournal/render-opts {:id \"aoc.2017.15/generate-value-result\"}}, :nextjournal/blob-id nil}, :nextjournal/render-opts {:id \"aoc.2017.15/generate-value-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/result-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-result, :hash \"5dryaWFamQn5VBuSHLJXGpfgbLUTKh\"}} {:path [], :nextjournal/value \"(defn parser [data]\\n  (->> data\\n       u/parse-out-longs))\", :nextjournal/render-opts {:loc {:line 22, :end-line 24, :column 1, :end-column 27}, :id \"aoc.2017.15/parser-code\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-block-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code-block, :hash \"5dtogCRMFvgKZ3gMGuwZAef65oxRZD\"}} {:path [], :nextjournal/value {:nextjournal/presented {:path [], :nextjournal/value \"#object[aoc.2017.15$parser 0x2ee32ead \\\"aoc.2017.15$parser@2ee32ead\\\"]\", :nextjournal/viewer {:name nextjournal.clerk.viewer/read+inspect-viewer, :render-fn #viewer-fn (fn [x] (try [nextjournal.clerk.render/inspect (nextjournal.clerk.viewer/read-string-without-tag-table x)] (catch js/Error _e (nextjournal.clerk.render/render-unreadable-edn x)))), :hash \"5du3nEWKL6ov9p2VcYkP5JLW7a9Hwz\"}, :nextjournal/render-opts {:id \"aoc.2017.15/parser-result\"}}, :nextjournal/blob-id nil}, :nextjournal/render-opts {:id \"aoc.2017.15/parser-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/result-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-result, :hash \"5dryaWFamQn5VBuSHLJXGpfgbLUTKh\"}} {:path [], :nextjournal/value \"(def input (->> (slurp (io/resource \\\"inputs/2017/15.txt\\\")) ;; Load the resource\\n                parser))                             ;; Split into lines\", :nextjournal/render-opts {:loc {:line 26, :end-line 27, :column 1, :end-column 25}, :id \"aoc.2017.15/input-code\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-block-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code-block, :hash \"5dtogCRMFvgKZ3gMGuwZAef65oxRZD\"}} {:path [], :nextjournal/value {:nextjournal/presented {:path [], :nextjournal/value [{:path [0], :nextjournal/value 512, :nextjournal/viewer {:name nextjournal.clerk.viewer/number-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-number, :hash \"5drsU4XXFvRiNxHZXiNRRP4gBX7jiW\"}} {:path [1], :nextjournal/value 191, :nextjournal/viewer {:name nextjournal.clerk.viewer/number-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-number, :hash \"5drsU4XXFvRiNxHZXiNRRP4gBX7jiW\"}}], :nextjournal/viewer {:name nextjournal.clerk.viewer/sequential-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-coll, :opening-paren \"(\", :closing-paren (\")\"), :page-size 20, :hash \"5dsbke2PwYQkQmXANR3WnQrqsZk2MW\"}, :nextjournal/render-opts {:id \"aoc.2017.15/input-result\"}}, :nextjournal/blob-id \"5dr7mT8AEyFKSipHzHZHD3ZeFHJH76\", :nextjournal/fetch-opts {:blob-id \"5dr7mT8AEyFKSipHzHZHD3ZeFHJH76\"}, :nextjournal/hash \"8Vx1QFAWcov5KVhhNsdMxKnrocZASjg2pHCXsWGphhdeNTTZixhEq3Zwqmuc8FS2M4TCZRB1Bpg34K65jaaxtQexkR\"}, :nextjournal/render-opts {:id \"aoc.2017.15/input-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/result-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-result, :hash \"5dryaWFamQn5VBuSHLJXGpfgbLUTKh\"}} {:path [], :nextjournal/value \"(defn count-matching-pairs [pairs]\\n  (->> pairs\\n       (reduce (fn [total pair]\\n                 (let [[a2 b2]\\n                       (map #(let [s          %\\n                                   bits       (Integer/toString s 2)\\n                                   pad        (- 16 (count bits))\\n                                   full       (if (> pad 0) (str (str/join \\\"\\\" (repeat pad \\\"0\\\")) bits) bits)\\n                                   count-full (count full)]\\n                               (subs full (- count-full 16) count-full))\\n                            pair)]\\n\\n\\n                   (if (= a2 b2)\\n                     (inc total)\\n                     total))) 0)))\", :nextjournal/render-opts {:loc {:line 30, :end-line 45, :column 1, :end-column 35}, :id \"aoc.2017.15/count-matching-pairs-code\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-block-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code-block, :hash \"5dtogCRMFvgKZ3gMGuwZAef65oxRZD\"}} {:path [], :nextjournal/value [:div.viewer.markdown-viewer.w-full.max-w-prose.px-8 {:data-block-id \"aoc.2017.15/markdown-5drFf1TXNZLn336Ph1vwbkx8cA6KDv\"} [\"h2\" {:id \"part-1\"} [:<> \"Part 1\"]]], :nextjournal/render-opts {:id \"aoc.2017.15/markdown-5drFf1TXNZLn336Ph1vwbkx8cA6KDv\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/markdown-node-viewer, :render-fn #viewer-fn identity, :hash \"5dsjzwxRkivFXiBf1NDMWmH54cVWV1\"}} {:path [], :nextjournal/value \"(defn part-1\\n  [[a-start b-start]]\\n  (let [dec-pairs (drop 1 (take 40000000\\n                                (iterate (fn [[prev-a prev-b]]\\n                                           [(generate-value prev-a a-factor)\\n                                            (generate-value prev-b b-factor)]) [a-start b-start])))]\\n\\n    (count-matching-pairs dec-pairs)))\", :nextjournal/render-opts {:loc {:line 48, :end-line 55, :column 1, :end-column 39}, :id \"aoc.2017.15/part-1-code\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-block-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code-block, :hash \"5dtogCRMFvgKZ3gMGuwZAef65oxRZD\"}} {:path [], :nextjournal/value \"(let [[a-start b-start] input\\n      dec-pairs         (drop 1 (take 5000000\\n                                      (iterate (fn [[prev-a prev-b]]\\n                                                 [(loop [a (generate-value prev-a a-factor)]\\n                                                    (if (zero? (mod a 4))\\n                                                      a\\n                                                      (recur (generate-value a a-factor))))\\n                                                  (loop [b (generate-value prev-b b-factor)]\\n                                                    (if (zero? (mod b 8))\\n                                                      b\\n                                                      (recur (generate-value b b-factor))))]) [a-start b-start])))]\\n\\n  (count-matching-pairs dec-pairs))\", :nextjournal/render-opts {:loc {:line 58, :end-line 70, :column 1, :end-column 36}, :id \"aoc.2017.15/anon-expr-5droeeYZ695AENskKP42n6gEBp7Z5h-code\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-block-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code-block, :hash \"5dtogCRMFvgKZ3gMGuwZAef65oxRZD\"}} {:path [], :nextjournal/value [:div.viewer.markdown-viewer.w-full.max-w-prose.px-8 {:data-block-id \"aoc.2017.15/markdown-5dqo1NXgLfjhMgxykGcEprXUno7u6y\"} [\"h2\" {:id \"part-2\"} [:<> \"Part 2\"]]], :nextjournal/render-opts {:id \"aoc.2017.15/markdown-5dqo1NXgLfjhMgxykGcEprXUno7u6y\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/markdown-node-viewer, :render-fn #viewer-fn identity, :hash \"5dsjzwxRkivFXiBf1NDMWmH54cVWV1\"}} {:path [], :nextjournal/value \"(defn part-2\\n  [data]\\n  (let [[a-start b-start] data\\n        dec-pairs         (drop 1 (take 5000000\\n                                        (iterate (fn [[prev-a prev-b]]\\n                                                   [(loop [a (generate-value prev-a a-factor)]\\n                                                      (if (zero? (mod a 4))\\n                                                        a\\n                                                        (recur (generate-value a a-factor))))\\n                                                    (loop [b (generate-value prev-b b-factor)]\\n                                                      (if (zero? (mod b 8))\\n                                                        b\\n                                                        (recur (generate-value b b-factor))))]) [a-start b-start])))]\\n\\n    (count-matching-pairs dec-pairs)))\", :nextjournal/render-opts {:loc {:line 74, :end-line 88, :column 1, :end-column 39}, :id \"aoc.2017.15/part-2-code\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-block-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code-block, :hash \"5dtogCRMFvgKZ3gMGuwZAef65oxRZD\"}} {:path [], :nextjournal/value [:div.viewer.markdown-viewer.w-full.max-w-prose.px-8 {:data-block-id \"aoc.2017.15/markdown-5dtDWouhgRcvd3akFfTpyZfsmDVeUm\"} [\"h1\" {:id \"tests\"} [:<> \"Tests\"]]], :nextjournal/render-opts {:id \"aoc.2017.15/markdown-5dtDWouhgRcvd3akFfTpyZfsmDVeUm\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/markdown-node-viewer, :render-fn #viewer-fn identity, :hash \"5dsjzwxRkivFXiBf1NDMWmH54cVWV1\"}} {:path [], :nextjournal/value \"(deftest test-2017-15\\n  (testing \\\"part one\\\"\\n    (is (= 567 (part-1 input))))\\n\\n  (testing \\\"part two\\\"\\n    (is (= 323 (part-2 input)))))\", :nextjournal/render-opts {:loc {:line 93, :end-line 98, :column 1, :end-column 34}, :id \"aoc.2017.15/test-2017-15-code\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-block-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code-block, :hash \"5dtogCRMFvgKZ3gMGuwZAef65oxRZD\"}}]}, :nextjournal/viewer {:name nextjournal.clerk.viewer/notebook-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-notebook, :hash \"5dsiHybTyGGTEpReRaV7nfNxoDgnKx\"}}}, :current-path \"src/aoc/2017/15\", :resource->url {\"/js/viewer.js\" \"https://storage.clerk.garden/nextjournal/clerk-assets@43sknWSpfsWGp1HAfZe1dLuBjmWH/viewer.js?immutable=true\", \"/css/viewer.css\" \"_data/8Vuwe3UJpobgAT3ZF2NrTxq6rma7qbTFQJqY7446NVYsKKtx7pDvDPmqj3eVzscvg78CsM2mkTWjF5Z1pXcvR3Wojh.css\"}, :index \"src/index.clj\"}".replaceAll('nextjournal.clerk.view/escape-closing-script-tag', 'script')
viewer.init(viewer.read_string(state))
</script></body></html>